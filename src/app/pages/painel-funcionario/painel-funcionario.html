<section class="painel-funcionario">

  <!-- ğŸ”¹ CabeÃ§alho -->
  <div class="painel-header">
    <h1>Painel do FuncionÃ¡rio</h1>
    <button class="sair-btn" (click)="sair()">Sair</button>
  </div>

  <!-- ğŸ”¹ Abas -->
  <nav class="tabs">
    <button type="button" (click)="abaSelecionada = 'professores'" [class.active]="abaSelecionada === 'professores'">ğŸ“‹ Cadastro de Aulas</button>
    <button type="button" (click)="abaSelecionada = 'aulas'" [class.active]="abaSelecionada === 'aulas'">ğŸ“… CalendÃ¡rio</button>
    <button type="button" (click)="abaSelecionada = 'alunos'" [class.active]="abaSelecionada === 'alunos'">ğŸ‘¶ Alunos</button>
    <button type="button" (click)="abaSelecionada = 'gerenciarProfessores'" [class.active]="abaSelecionada === 'gerenciarProfessores'">ğŸ‘¨â€ğŸ« Professores</button>
    <button type="button" (click)="abaSelecionada = 'turmas'" [class.active]="abaSelecionada === 'turmas'">ğŸ« Turmas</button>
    <button type="button" (click)="abaSelecionada = 'matriculas'" [class.active]="abaSelecionada === 'matriculas'">ğŸ“ MatrÃ­culas</button>
  </nav>

  <!-- ===================================================== -->
  <!-- ğŸ”¹ ABA: CADASTRO DE AULAS -->
  <!-- ===================================================== -->
  <section *ngIf="abaSelecionada === 'professores'" class="content">
    <h2>{{ aulaEditando ? 'EdiÃ§Ã£o de Aulas' : 'Cadastro de Aulas' }}</h2>

    <form (submit)="aulaEditando ? salvarEdicao() : adicionarAula($event)" class="form-cadastro">

      <input type="text" placeholder="TÃ­tulo da aula" required [(ngModel)]="novaAula.titulo" name="titulo" />

      <input type="date" required [(ngModel)]="novaAula.data" name="data" />

      <input type="time" required step="300" [(ngModel)]="novaAula.hora" name="hora" />

      <select required [(ngModel)]="novaAula.professorId" name="professor">
        <option value="" disabled selected>Escolha o professor</option>
        <option *ngFor="let prof of professores" [value]="prof.id">{{ prof.nome }}</option>
      </select>

      <button class="submit-btn" type="submit">
        {{ aulaEditando ? 'Salvar EdiÃ§Ã£o' : 'Adicionar Aula' }}
      </button>

      <button *ngIf="aulaEditando" type="button" class="cancel-btn"
              (click)="aulaEditando = null; novaAula = { titulo: '', data: '', hora: '', professorId: null }">
        Cancelar
      </button>

    </form>

    <ul class="lista">
      <li *ngFor="let aula of aulas">
        <span class="info">{{ aula.titulo }} â€” {{ aula.data }} Ã s {{ aula.hora }}</span>
        <div class="acoes">
          <button type="button" class="editar-btn" (click)="prepararEdicao(aula)">Editar</button>
          <button type="button" class="remover-btn" (click)="removerAula(aula.id)">Remover</button>
        </div>
      </li>
    </ul>
  </section>

  <!-- ===================================================== -->
  <!-- ğŸ”¹ ABA: CALENDÃRIO -->
  <!-- ===================================================== -->
  <section *ngIf="abaSelecionada === 'aulas'" class="content">
    <h2>ğŸ“… Aulas Marcadas</h2>
    <app-calendario [eventos]="aulas"></app-calendario>
  </section>

  <!-- ===================================================== -->
  <!-- ğŸ”¹ ABA: ALUNOS -->
  <!-- ===================================================== -->
  <section *ngIf="abaSelecionada === 'alunos'" class="content">
    <h2>{{ alunoEditando ? 'Editar Aluno' : 'Cadastro de Alunos' }}</h2>

    <form (submit)="alunoEditando ? salvarEdicaoAluno() : adicionarAluno($event)" class="form-cadastro">

      <input type="text" placeholder="Nome do aluno" required [(ngModel)]="novoAluno.nome" name="alunoNome" />

      <input type="date" required [(ngModel)]="novoAluno.dataNascimento" name="dataNascimento" />

      <input type="text" placeholder="Nome do responsÃ¡vel" required [(ngModel)]="novoAluno.nomeResponsavel" name="nomeResponsavel" />

      <input type="text" placeholder="CPF do responsÃ¡vel" maxlength="14" required
             [(ngModel)]="novoAluno.cpfResponsavel" name="cpfResponsavel"
             (input)="aplicarMascaraCPFResponsavel()" [class.invalido]="cpfResponsavelInvalido" />

      <p *ngIf="cpfResponsavelInvalido" class="erro-cpf">CPF invÃ¡lido. Verifique e tente novamente.</p>

      <input type="email" placeholder="Email do responsÃ¡vel" required [(ngModel)]="novoAluno.emailResponsavel" name="emailResponsavel" />

      <input type="tel" placeholder="Telefone do responsÃ¡vel" required [(ngModel)]="novoAluno.telefoneResponsavel" name="telefoneResponsavel" />

      <button class="submit-btn" type="submit" [disabled]="cpfResponsavelInvalido">
        {{ alunoEditando ? 'Salvar EdiÃ§Ã£o' : 'Adicionar Aluno' }}
      </button>

      <button *ngIf="alunoEditando" type="button" class="cancel-btn" (click)="cancelarEdicaoAluno()">Cancelar</button>

    </form>

    <ul class="lista">
      <li *ngFor="let aluno of alunos">
        <span class="info">{{ aluno.nome }} â€” {{ aluno.dataNascimento }} â€” ResponsÃ¡vel: {{ aluno.nomeResponsavel }}</span>
        <div class="acoes">
          <button type="button" class="editar-btn" (click)="prepararEdicaoAluno(aluno)">Editar</button>
          <button type="button" class="remover-btn" (click)="removerAluno(aluno.id)">Remover</button>
        </div>
      </li>
    </ul>
  </section>

  <!-- ===================================================== -->
  <!-- ğŸ”¹ ABA: PROFESSORES -->
  <!-- ===================================================== -->
  <section *ngIf="abaSelecionada === 'gerenciarProfessores'" class="content">
    <h2>{{ professorEditando ? 'Editar Professor' : 'Cadastro de Professores' }}</h2>

    <form (submit)="professorEditando ? salvarEdicaoProfessor() : adicionarProfessor($event)" class="form-cadastro">

      <input type="text" placeholder="Nome do professor" required [(ngModel)]="novoProfessor.nome" name="profNome" />

      <input type="text" placeholder="CPF" maxlength="14" required
             [(ngModel)]="novoProfessor.cpf" name="profCpf"
             (input)="aplicarMascaraCPF()" [class.invalido]="cpfInvalido" />

      <p *ngIf="cpfInvalido" class="erro-cpf">CPF invÃ¡lido. Verifique e tente novamente.</p>

      <button class="submit-btn" type="submit" [disabled]="cpfInvalido">
        {{ professorEditando ? 'Salvar EdiÃ§Ã£o' : 'Adicionar Professor' }}
      </button>

      <button *ngIf="professorEditando" type="button" class="cancel-btn"
              (click)="cancelarEdicaoProfessor()">Cancelar</button>

    </form>

    <ul class="lista">
      <li *ngFor="let professor of professores">
        <span class="info">
          {{ professor.nome }} â€” CPF: {{ professor.cpf }} â€” Contratado em: {{ professor.dataContratacao }}
        </span>
        <div class="acoes">
          <button class="editar-btn" (click)="prepararEdicaoProfessor(professor)">Editar</button>
          <button class="remover-btn" (click)="removerProfessor(professor.id)">Remover</button>
        </div>
      </li>
    </ul>
  </section>

  <!-- ===================================================== -->
  <!-- ğŸ”¹ ABA: TURMAS -->
  <!-- ===================================================== -->
  <section *ngIf="abaSelecionada === 'turmas'" class="content">

    <h2>{{ turmaEditando ? 'Editar Turma' : 'Cadastro de Turmas' }}</h2>

    <form (submit)="turmaEditando ? salvarEdicaoTurma() : adicionarTurma($event)" class="form-cadastro">

      <input type="text" placeholder="Nome da turma" required [(ngModel)]="novaTurma.nome" name="turmaNome" />

      <input type="number" placeholder="Idade mÃ­nima" [(ngModel)]="novaTurma.faixaEtariaMinima" name="minima" />

      <input type="number" placeholder="Idade mÃ¡xima" [(ngModel)]="novaTurma.faixaEtariaMaxima" name="maxima" />

      <input type="text" placeholder="Dias da semana (ex: Seg/Qua)" [(ngModel)]="novaTurma.diaSemana" name="dias" />

      <input type="time" [(ngModel)]="novaTurma.horarioInicio" name="inicio" />

      <input type="time" [(ngModel)]="novaTurma.horarioFim" name="fim" />

      <input type="number" placeholder="Limite de alunos" [(ngModel)]="novaTurma.limiteAlunos" name="limite" />

      <select required name="professorId" [(ngModel)]="novaTurma.professorId">
        <option value="" disabled selected>Professor responsÃ¡vel</option>
        <option *ngFor="let p of professores" [value]="p.id">{{ p.nome }}</option>
      </select>

      <!-- ğŸ”¥ SELECIONAR ALUNOS PARA MATRÃCULA AUTOMÃTICA -->
      <h3>Selecionar Alunos para a Turma</h3>

      <div class="lista-alunos-turma">
        <label *ngFor="let aluno of alunos" class="aluno-checkbox">
          <input type="checkbox"
                 [value]="aluno.id" />
          {{ aluno.nome }} â€” {{ aluno.dataNascimento }}
        </label>
      </div>

      <button type="submit" class="submit-btn">
        {{ turmaEditando ? 'Salvar EdiÃ§Ã£o' : 'Cadastrar Turma' }}
      </button>

      <button *ngIf="turmaEditando" class="cancel-btn" type="button"
              (click)="cancelarEdicaoTurma()">
        Cancelar
      </button>

    </form>

    <h3>Turmas Cadastradas</h3>

    <ul class="lista">
      <li *ngFor="let t of turmas">
        <span class="info">
          <b>{{ t.nome }}</b> â€” {{ t.faixaEtariaMinima }} a {{ t.faixaEtariaMaxima }} anos â€” Prof: {{ t.professor.nome }}
        </span>

        <div class="acoes">
          <button class="editar-btn" (click)="prepararEdicaoTurma(t)">Editar</button>
          <button class="remover-btn" (click)="removerTurma(t.id)">Remover</button>
        </div>
      </li>
    </ul>

  </section>

  <!-- ===================================================== -->
  <!-- ğŸ”¹ ABA: MATRÃCULAS -->
  <!-- ===================================================== -->
  <section *ngIf="abaSelecionada === 'matriculas'" class="content">

    <h2>ğŸ“‹ MatrÃ­culas</h2>

    <ul class="lista">
      <li *ngFor="let m of matriculas">
        <span class="info">
          <b>MatrÃ­cula nÂº {{ m.id }}</b><br>
          ğŸ‘¤ Aluno: {{ m.aluno.nome }}<br>
          ğŸ« Turma: {{ m.turma.nome }}<br>
          ğŸ“… Data: {{ m.dataMatricula | date:'dd/MM/yyyy' }}<br>
          ğŸ”– Status: {{ m.status }}
        </span>

        <div class="acoes">
          <button type="button" class="editar-btn" (click)="trancarMatricula(m.id)">
            Trancar
          </button>

          <button type="button" class="remover-btn"
                  (click)="deletarMatricula(m.id)">
            Remover
          </button>
        </div>
      </li>
    </ul>

    <p *ngIf="matriculas.length === 0">
      Nenhuma matrÃ­cula cadastrada ainda.
    </p>

  </section>

</section>
